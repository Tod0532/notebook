# 动计笔记 (MovePlan Memo) - 需求说明

## 项目概述

一款将**日常记事**、**智能提醒**、**运动追踪**、**目标计划**四模块深度融合的移动端生活管理APP。用户不仅能记录笔记、设置提醒、追踪运动，还能制定并执行各类计划（运动、生活习惯、工作目标等）。通过AI辅助、游戏化设计、数据可视化等有趣功能，帮助用户养成良好习惯、坚持运动、达成目标。

## 目标用户

- 希望兼顾工作/学习与运动的上班族、学生
- 健身爱好者、想养成运动习惯的人
- 需要结构化规划生活与目标的用户
- 华语地区用户（支持简体中文、粤语语音、本地天气服务）

## 核心功能模块

### 1. 记事本模块

富文本笔记记录，支持多维度组织和检索。

| 功能点 | 优先级 | 说明 |
|--------|--------|------|
| 基础CRUD | P0 | 新建、编辑、删除、查看笔记 |
| 笔记列表 | P0 | 展示所有笔记，按时间排序 |
| 标签系统 | P0 | 每条笔记可添加多个标签 |
| 按标签筛选 | P1 | 点击标签看相关笔记 |
| 搜索功能 | P1 | 全文搜索标题和内容 |
| 文件夹分类 | P2 | 多级文件夹结构 |
| 富文本编辑 | P2 | 粗体、列表、标题等 |
| 图片插入 | P2 | 插入本地图片 |
| 语音记录 | P3 | 录音并插入笔记 |
| 版本历史 | P3 | 记录修改历史 |
| 导出功能 | P3 | 导出为 PDF/MD |
| 回收站 | P3 | 软删除，可恢复 |

### 2. 提醒模块

灵活的提醒系统，确保重要事项不被遗忘。

| 功能点 | 优先级 | 说明 |
|--------|--------|------|
| 单次提醒 | P0 | 设定具体时间提醒 |
| 提醒列表 | P0 | 展示所有提醒 |
| 本地推送 | P0 | 到时推送通知 |
| 每日重复 | P1 | 每天同一时间提醒 |
| 每周重复 | P1 | 选定星期几提醒 |
| 完成标记 | P1 | 勾选完成 |
| 早安推送 | P2 | 汇总今日计划+待办 |
| 习惯提醒 | P2 | 如"每天8点喝水" |
| 位置提醒 | P3 | 到达/离开某地触发 |
| 小组件 | P3 | 桌面小组件 |

### 3. 运动追踪模块

全面的运动数据记录与分析。

| 功能点 | 优先级 | 说明 |
|--------|--------|------|
| 手动记录 | P0 | 选类型+时长+备注 |
| 运动历史 | P0 | 展示所有运动记录 |
| 运动类型库 | P0 | 预设20+运动类型 |
| 基础统计 | P1 | 本周/本月运动次数 |
| GPS追踪 | P2 | 实时记录轨迹 |
| 卡路里计算 | P2 | 根据类型/时长估算 |
| 健康平台同步 | P2 |小米/华为健康 |
| 数据可视化 | P2 | 趋势图、热力图 |
| 感受记录 | P3 | 记录运动后感受 |
| 配速计算 | P3 | 跑步/骑行配速 |

#### 运动类型枚举（20+）

- **有氧类**：跑步、骑行、游泳、跳绳、HIIT、有操、爬楼梯
- **力量类**：胸肌、背肌、腿部、肩部、手臂、核心、全身
- **球类**：篮球、足球、羽毛球、乒乓球
- **其他**：瑜伽、普拉提、徒步、登山、冥想、拉伸

### 4. 计划模块

将大目标分解为可执行任务的核心枢纽。

| 功能点 | 优先级 | 说明 |
|--------|--------|------|
| 创建计划 | P0 | 设目标名称+截止日期 |
| 任务分解 | P0 | 手动添加子任务 |
| 每日清单 | P0 | 每日待办任务视图 |
| 进度展示 | P0 | 完成度百分比 |
| 自动打卡 | P1 | 运动/笔记关联自动勾选 |
| 日历视图 | P1 | 日历展示任务分布 |
| 模板库 | P2 | 预设计划模板 |
| AI生成计划 | P2 | 输入目标自动生成 |
| 甘特图 | P3 | 可视化时间线 |
| 里程碑 | P3 | 关键节点提醒 |

## 模块间关联

```
┌─────────────────────────────────────────────────────────────┐
│                        计划模块                               │
│                     (Plan / PlanTask)                        │
│                         ↓    ↓                               │
│           自动生成提醒    ↓    ↓    运动打卡自动完成           │
│               ┌───────────┘    └──────────┐                  │
│               ↓                              ↓                │
│        ┌─────────────┐               ┌─────────────┐          │
│        │   提醒模块    │               │  运动模块    │          │
│        │ (Reminder)  │               │ (Workout)   │          │
│        └──────┬──────┘               └──────┬──────┘          │
│               │                              │                 │
│               └───────────┬──────────────────┘                 │
│                           ↓                                    │
│                    运动后自动生成笔记小结                        │
│                    ┌─────────────┐                             │
│                    │   记事本模块   │                             │
│                    │    (Note)   │                             │
│                    └─────────────┘                             │
└─────────────────────────────────────────────────────────────┘
```

### 关联规则

| 触发事件 | 自动操作 | 说明 |
|----------|----------|------|
| 创建计划任务 | 自动创建提醒 | 按任务时间生成提醒 |
| 完成运动记录 | 勾选关联计划任务 | 运动打卡 → 计划进度+1 |
| 完成运动 | 自动生成笔记 | AI生成运动小结 |
| 完成计划任务 | 勾选关联提醒 | 避免重复通知 |
| 创建运动笔记 | 关联运动记录 | 可跳转查看 |

## 亮点功能

1. **AI运动教练与计划生成** - DeepSeek 辅助制定个性化计划
2. **运动后AI自动生成笔记小结** - 自动总结训练内容
3. **游戏化系统** - 连击（Streak）、成就徽章、等级、积分商店
4. **每日/每周挑战与抽卡系统** - 增加趣味性
5. **智能天气适配** - 根据天气推荐室内/户外运动
6. **情绪分析** - 从笔记判断情绪 → 建议运动类型
7. **睡眠/饮食简易联动** - 可选功能
8. **语音交互** - 粤语/普通话新建记录、查询进度
9. **番茄专注 + 运动休息模式** - 工作休息结合
10. **个性化主题与动态小组件** - 自定义外观
11. **位置智能提醒** - 到公园自动建议运动
12. **年度运动回忆视频 / 热力图** - 年度总结

## 非功能需求

| 项目 | 要求 |
|------|------|
| **平台** | Android 优先，Flutter 跨平台 |
| **离线优先** | 核心功能完全离线可用 |
| **隐私安全** | 数据本地加密、生物识别锁、可关闭云同步 |
| **多语言** | 简体中文、英文 |
| **性能** | 启动快、支持万级数据、GPS低耗电 |
| **AI服务** | DeepSeek API |

## 技术栈（2025 推荐版）

> 详细技术架构请参考 [技术架构方案.md](./技术架构方案.md)

| 组件 | 技术选择 | 版本要求 |
|------|----------|----------|
| 前端框架 | Flutter | 3.19+ |
| 开发语言 | Dart | 3.0+ |
| **状态管理** | **Riverpod** | 2.4+ |
| **本地数据库** | **Drift** | 2.14+ |
| 路由管理 | **go_router** | 13.0+ |
| 本地存储 | shared_preferences | 2.2+ |
| 网络请求 | dio | 5.4+ |
| 日期处理 | intl | 0.19+ |
| 富文本编辑 | flutter_quill | 9.0+ |
| 图表 | fl_chart | 0.67+ |
| 地图 | flutter_map | - |
| 推送 | flutter_local_notifications | 16.0+ |
| 定位 | geolocator | 11.0+ |
| 健康数据 | **huawei_health** | - |
| AI服务 | DeepSeek API | - |

### 关键技术决策说明

| 决策 | 原因 |
|------|------|
| **Riverpod（直接用）** | 比 setState 简单、代码少、可测试、一次到位 |
| **Drift（替代 Hive/Isar）** | 关系查询支持、编译时安全、适合多关联项目 |
| **go_router（直接用）** | 类型安全、深链接支持、官方推荐 |
